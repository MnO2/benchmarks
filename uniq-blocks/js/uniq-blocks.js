// Generated by CoffeeScript 1.9.1
(function() {
  var BlockStream, block, d, dedupeFile, filename, fs, lazy, path, printLine, rstream, usage;

  fs = require('fs');

  path = require('path');

  lazy = require('lazy');

  BlockStream = require('block-stream');

  printLine = function(line) {
    return process.stdout.write(line + '\n');
  };

  usage = function() {
    return printLine("Usage: " + process.argv[1] + " <filename>");
  };

  if (process.argv.length < 3) {
    usage();
    process.exit(0);
  } else {
    filename = process.argv[2];
    printLine("reading " + filename + " ...");
    d = {};
    dedupeFile = function(chunk) {
      if (chunk in d) {
        return d[chunk] += 1;
      } else {
        return d[chunk] = 1;
      }
    };
    block = new BlockStream(512);
    rstream = fs.createReadStream(filename).pipe(block);
    block.on('data', function(chunk) {
      return dedupeFile(chunk);
    });
    block.on('end', function() {
      return printLine('Done');
    });
  }

}).call(this);
